<main id="post-319488">
<article>
<header class="mega-header">
<style>
    body::after {
      opacity: 0.91;
    }
    body::before {
      content: "";
      background-image: 
        url(https://css-tricks.com/wp-content/uploads/2020/08/github-actions-image-opt.png);
    }
  </style>
<div class="tags">
<font _mstmutation="1" _msthash="975507" _msttexthash="425243"><a href="https://css-tricks.com/tag/github/" rel="tag" _mstmutation="1">github</a> <a href="https://css-tricks.com/tag/github-actions/" rel="tag" _mstmutation="1">github actions</a></font> </div>
<h1 class="article-title" _msthash="887029" _msttexthash="1249066"> Optimiser les images avec une action GitHub </h1>
<div class="author-row">
<a href="https://css-tricks.com/author/chriscoyier/" aria-label="Page d’auteur de Chris Coyier" _mstaria-label="1906333">
<img alt="Avatar of Chris Coyier" src="https://secure.gravatar.com/avatar/8081b26e05bb4354f7d65ffc34cbbd67?s=80&amp;d=retro&amp;r=pg" srcset="https://secure.gravatar.com/avatar/8081b26e05bb4354f7d65ffc34cbbd67?s=160&amp;d=retro&amp;r=pg 2x" class="avatar avatar-80 photo skip-lazy" height="80" width="80" loading="lazy"><noscript><img alt='Avatar of Chris Coyier' src='https://secure.gravatar.com/avatar/8081b26e05bb4354f7d65ffc34cbbd67?s=80&#038;d=retro&#038;r=pg' srcset='https://secure.gravatar.com/avatar/8081b26e05bb4354f7d65ffc34cbbd67?s=160&#038;d=retro&#038;r=pg 2x' class='avatar avatar-80 photo skip-lazy' height='80' width='80' loading='lazy'/></noscript> </a>
<div>
<font _mstmutation="1" _msthash="1277588" _msttexthash="501566"><a class="author-name" href="https://css-tricks.com/author/chriscoyier/" _mstmutation="1" _istranslated="1">Chris Coyier</a> <time title="Originally published Aug 20, 2020" datetime="" _mstmutation="1" _istranslated="1">le 20 août 2020</time></font>
</div>
</div>
</header>
<div class="article-sponsor">
<div>
<p>
<a href="https://awsamplify.info/css" _msthash="1153945" _msttexthash="294866">Amplification AWS</a><font _mstmutation="1" _msthash="986011" _msttexthash="14508468"> - le moyen le plus rapide et le plus facile de développer des applications mobiles et Web à l’échelle. </font></p>
</div>
</div>
<div class="article-content">
<p _msthash="722501" _msttexthash="99640892">Je jouais avec <a href="https://github.com/features/actions" _istranslated="1">GitHub Actions l'</a> autre jour. Un si bel outil! Nouvelle : vous pouvez l’avoir exécuter du code pour vous, comme exécuter vos processus de build, tests et déploiements. Mais ce ne sont que des fichiers de configuration qui peuvent exécuter tout ce dont vous avez besoin. Il ya <a href="https://github.com/marketplace" _istranslated="1">tout un marché d’actions</a> qui veulent faire du travail pour vous. </p>
<p _msthash="722982" _msttexthash="55109249">Ce que je voulais faire était d’exécuter du code pour faire l’optimisation de l’image. Comme ça, je n’ai jamais à y penser. N’importe quelle image dans le repo a été optimisée.</p>
<span id="more-319488"></span>
<p _msthash="724425" _msttexthash="77480000">Il y a déjà une action pour cela, les <a href="https://github.com/calibreapp/image-actions" _istranslated="1">actions d’image de</a>Calibre, que nous allons tirer parti ici. Vous devrez également vous assurer que les actions sont activées pour le repo. Je sais que dans mon organisation principale, nous ne basculons sur les actions sur une base par repo, qui est l’une des options.</p>
<figure class="wp-block-image size-large"><img loading="eager" width="1024" height="731" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1024%2C731&amp;ssl=1" alt="" class="wp-image-319530 jetpack-lazy-image jetpack-lazy-image--handled" data-recalc-dims="1" srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1024%2C731&amp;ssl=1 1024w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=300%2C214&amp;ssl=1 300w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=768%2C548&amp;ssl=1 768w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1536%2C1097&amp;ssl=1 1536w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=2048%2C1463&amp;ssl=1 2048w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1000%2C714&amp;ssl=1 1000w" data-lazy-loaded="1" sizes="(min-width: 735px) 864px, 96vw"><noscript><img loading="lazy" width="1024" height="731" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1024%2C731&#038;ssl=1" alt="" class="wp-image-319530" srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1024%2C731&amp;ssl=1 1024w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=300%2C214&amp;ssl=1 300w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=768%2C548&amp;ssl=1 768w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1536%2C1097&amp;ssl=1 1536w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=2048%2C1463&amp;ssl=1 2048w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/github-actions-branch.png?resize=1000%2C714&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p><font _mstmutation="1" _msthash="725387" _msttexthash="285532546">Ensuite, vous faites un fichier à . C’est là que vous pouvez configurer cette action. Toutes vos actions peuvent avoir des fichiers distincts, si vous le souhaitez. J’ai fait de ce fichier un fichier distinct parce que (1) il ne fonctionne qu’avec «&nbsp;pousse à tirer des demandes,&nbsp;» donc si vous avez d’autres actions qui s’exécutent sur différents déclencheurs, ils ne se mélangeront pas bien, et (2) C’est ce qui est dans leurs docs et ressemble à l’utilisation suggérée.</font><code>./github/workflows/optimize-images.yml</code></p>
<figure class="wp-block-image size-large"><img loading="eager" width="1024" height="549" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1024%2C549&amp;ssl=1" alt="" class="wp-image-319491 jetpack-lazy-image jetpack-lazy-image--handled" data-recalc-dims="1" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1024%2C549&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=300%2C161&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=768%2C412&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1536%2C824&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=2048%2C1099&amp;ssl=1 2048w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1000%2C536&amp;ssl=1 1000w" data-lazy-loaded="1" sizes="(min-width: 735px) 864px, 96vw"><noscript><img loading="lazy" width="1024" height="549" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1024%2C549&#038;ssl=1" alt="" class="wp-image-319491" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1024%2C549&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=300%2C161&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=768%2C412&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1536%2C824&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=2048%2C1099&amp;ssl=1 2048w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.06.48-AM.png?resize=1000%2C536&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<pre rel="HTML" class="wp-block-csstricks-code-block  language-html" data-line=""><code markup="tt" class=" language-html">name: Optimize images
on: pull_request
jobs:
  build:
    name: calibreapp/image-actions
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@master

      - name: Compress Images
        uses: calibreapp/image-actions@master
        with:
          githubToken: ${{ secrets.GITHUB_TOKEN }}</code></pre>
<p _msthash="746213" _msttexthash="17721834">Maintenant, si vous faites une demande de traction, vous verrez qu’il s’exécute:</p>
<figure class="wp-block-image size-large"><img loading="eager" width="1024" height="827" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1024%2C827&amp;ssl=1" alt="" class="wp-image-319493 jetpack-lazy-image jetpack-lazy-image--handled" data-recalc-dims="1" srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1024%2C827&amp;ssl=1 1024w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=300%2C242&amp;ssl=1 300w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=768%2C620&amp;ssl=1 768w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1536%2C1240&amp;ssl=1 1536w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1000%2C807&amp;ssl=1 1000w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?w=2044&amp;ssl=1 2044w" data-lazy-loaded="1" sizes="(min-width: 735px) 864px, 96vw"><noscript><img loading="lazy" width="1024" height="827" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1024%2C827&#038;ssl=1" alt="" class="wp-image-319493" srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1024%2C827&amp;ssl=1 1024w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=300%2C242&amp;ssl=1 300w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=768%2C620&amp;ssl=1 768w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1536%2C1240&amp;ssl=1 1536w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?resize=1000%2C807&amp;ssl=1 1000w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.15-AM.png?w=2044&amp;ssl=1 2044w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p _msthash="747201" _msttexthash="27788189">Cette course réussie laisse alors un commentaire sur la demande de traction en disant ce qu’il a été en mesure d’optimiser:</p>
<figure class="wp-block-image size-large"><img loading="eager" width="1024" height="331" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=1024%2C331&amp;ssl=1" alt="" class="wp-image-319495 jetpack-lazy-image jetpack-lazy-image--handled" data-recalc-dims="1" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=1024%2C331&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=300%2C97&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=768%2C248&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=1000%2C323&amp;ssl=1 1000w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?w=1528&amp;ssl=1 1528w" data-lazy-loaded="1" sizes="(min-width: 735px) 864px, 96vw"><noscript><img loading="lazy" width="1024" height="331" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=1024%2C331&#038;ssl=1" alt="" class="wp-image-319495" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=1024%2C331&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=300%2C97&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=768%2C248&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?resize=1000%2C323&amp;ssl=1 1000w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.56.07-AM.png?w=1528&amp;ssl=1 1528w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p _msthash="748189" _msttexthash="36858809">Il va littéralement ré-valider ces fichiers à la demande de traction ainsi, donc si vous allez rester sur la demande de traction et continuer à travailler, vous aurez besoin de pousser à nouveau avant que vous puissiez pousser pour obtenir les images optimisées.</p>
<p _msthash="748683" _msttexthash="3003637">Je peux regarder cette validation automatique et voir la différence:</p>
<figure class="wp-block-image size-large"><img loading="lazy" width="1004" height="954" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=1004%2C954&amp;ssl=1" alt="" class="wp-image-319494 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?w=1004&amp;ssl=1 1004w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=300%2C285&amp;ssl=1 300w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=768%2C730&amp;ssl=1 768w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=1000%2C950&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=1004%2C954&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1004" height="954" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=1004%2C954&#038;ssl=1" alt="" class="wp-image-319494" srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?w=1004&amp;ssl=1 1004w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=300%2C285&amp;ssl=1 300w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=768%2C730&amp;ssl=1 768w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-8.57.30-AM.png?resize=1000%2C950&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption _msthash="1825850" _msttexthash="718042">The commit preview in Git Tower.</figcaption></figure>
<p _msthash="749671" _msttexthash="1069601">How I can merge the PR knowing all is well:</p>
<figure class="wp-block-image size-large"><img loading="lazy" width="1024" height="485" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1024%2C485&amp;ssl=1" alt="" class="wp-image-319496 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1024%2C485&amp;ssl=1 1024w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=300%2C142&amp;ssl=1 300w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=768%2C364&amp;ssl=1 768w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1000%2C474&amp;ssl=1 1000w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?w=1524&amp;ssl=1 1524w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1024%2C485&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1024" height="485" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1024%2C485&#038;ssl=1" alt="" class="wp-image-319496" srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1024%2C485&amp;ssl=1 1024w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=300%2C142&amp;ssl=1 300w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=768%2C364&amp;ssl=1 768w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?resize=1000%2C474&amp;ssl=1 1000w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/08/Screen-Shot-2020-08-18-at-9.10.44-AM.png?w=1524&amp;ssl=1 1524w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p _msthash="750659" _msttexthash="42449784">Pretty cool. Is optimizing your images locally particularly hard? No. Is never having to think about it again better? Yeah. You’re taking on a smidge of technical debt here, but reducing it elsewhere, which is a very fair trade, at least in my book.</p>
</div>
</article>
</main>
